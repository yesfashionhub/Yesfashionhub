<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YES FASHION HUB - WhatsApp Store</title>
<link rel="stylesheet" href="style.css">
<style>
/* Same as previous CSS */
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial, sans-serif;}
body{background:#f7f7f7;color:#111;line-height:1.4;}
.container{max-width:1100px;margin:0 auto;padding:10px;}
header{display:flex;align-items:center;justify-content:space-between;background:#fff;padding:12px;border-radius:10px;box-shadow:0 4px 12px rgba(0,0,0,0.05);}
.brand{display:flex;align-items:center;gap:12px;}
.brand img{width:50px;height:50px;object-fit:cover;border-radius:8px;}
.cart-btn{position:relative;background:#0ea5a4;color:#fff;padding:8px 12px;border-radius:10px;cursor:pointer;border:none;}
.cart-count{position:absolute;top:-6px;right:-6px;background:#ef4444;width:20px;height:20px;border-radius:50%;color:#fff;display:flex;align-items:center;justify-content:center;font-size:0.75rem;}
.hero{margin-top:15px;border-radius:12px;overflow:hidden;}
.hero img{width:100%;height:220px;object-fit:cover;}
.filters{display:flex;gap:10px;margin-top:15px;flex-wrap:wrap;}
.search{flex:1;display:flex;gap:8px;}
.search input,.select{padding:10px;border-radius:8px;border:1px solid #ddd;background:#fff;width:100%;}
.select{max-width:220px;}
.products{margin-top:18px;display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px;}
.card{background:#fff;border-radius:12px;padding:12px;box-shadow:0 6px 15px rgba(0,0,0,0.05);display:flex;flex-direction:column;gap:8px;}
.prod-img{width:100%;height:150px;border-radius:8px;object-fit:cover;background:#eee;}
.prod-name{font-weight:600;font-size:1rem;}
.prod-desc{font-size:0.88rem;color:#555;min-height:36px;}
.price{font-weight:700;font-size:1rem;}
.add-btn{background:#06b6d4;color:white;padding:8px;border-radius:8px;border:none;cursor:pointer;}
footer{margin-top:22px;padding:18px;background:#fff;border-radius:12px;text-align:center;color:#555;font-size:0.9rem;}
.cart-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.4);display:none;justify-content:center;align-items:center;z-index:999;}
.cart-content{background:#fff;padding:20px;border-radius:12px;max-width:500px;width:90%;max-height:80%;overflow-y:auto;}
.cart-item{display:flex;align-items:center;gap:12px;padding:8px;border-bottom:1px solid #eee;}
.cart-item img{width:60px;height:60px;object-fit:cover;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.1);}
.cart-item-info{flex:1;}
.cart-item-name{font-weight:600;font-size:0.95rem;}
.cart-item-price{font-size:0.85rem;color:#555;margin-top:2px;}
.cart-close{cursor:pointer;background:#ef4444;color:#fff;padding:6px 10px;border:none;border-radius:6px;margin-bottom:10px;}
.generate-pdf{background:#0ea5a4;color:white;padding:10px;border:none;border-radius:8px;width:100%;cursor:pointer;margin-top:10px;}
</style>
</head>  
<body>

<div class="container">
  <header>
    <div class="brand">
      <img src="images/logo.png" alt="logo">
      <div>
        <h1>YES FASHION HUB</h1>
        <div style="font-size:0.85rem;color:#555;">WhatsApp Store</div>
      </div>
    </div>
    <button class="cart-btn" id="viewCartBtn">Cart <span class="cart-count" id="cartCount">0</span></button>
  </header>

  <div class="hero"><img src="images/hero.jpg" alt="banner"></div>

  <div class="filters">
    <div class="search"><input type="search" id="searchInput" placeholder="Search Products..."></div>
    <select id="categoryFilter" class="select"><option value="all">All Categories</option></select>
  </div>

  <h2 style="margin-top:15px;">All Products</h2>
  <div class="products" id="productsGrid"></div>

  <footer>
    YES FASHION HUB • Near Patelwadi, Pedak Road, Rajkot • Email: yesfashionhub@gmail.com
  </footer>
</div>

<div class="cart-modal" id="cartModal">
  <div class="cart-content">
    <button class="cart-close" id="closeCartBtn">Close</button>
    <div id="cartItems"></div>
    <button class="generate-pdf" id="generatePDFBtn">Generate PDF & Share via WhatsApp</button>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="script.js">
const SHEET_ID = '1VbT9BCz5_dzYPe_-ClJJPIKbGuwPXKEEXseKn49VzGk';
const WHATSAPP_NUMBER = '919978051852';
let PRODUCTS = [];
let cart = {};

async function loadProducts(){
  const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;
  const res = await fetch(url);
  const text = await res.text();
  const data = JSON.parse(text.substr(47).slice(0,-2));
  const rows = data.table.rows;

  PRODUCTS = rows.map((r,i)=>({
    id: 'P'+(i+1).toString().padStart(3,'0'),
    category: r.c[1]?.v || '',
    name: r.c[2]?.v || '',
    description: r.c[3]?.v || '',
    image: r.c[4]?.v || 'images/placeholder.jpg',
    size: r.c[5]?.v || '',
    price: r.c[6]?.v || 0
  }));

  renderProducts();
  populateCategories();
}

const grid = document.getElementById('productsGrid');
const filter = document.getElementById('categoryFilter');
const search = document.getElementById('searchInput');

function renderProducts(){
  const q = search.value.toLowerCase();
  const cat = filter.value;
  grid.innerHTML='';
  const filtered = PRODUCTS.filter(p=> (cat==='all'||p.category===cat) && (p.name.toLowerCase().includes(q)||p.description.toLowerCase().includes(q)));
  filtered.forEach(p=>{
    const card = document.createElement('div');
    card.className='card';
    card.innerHTML=`
      <img src="${p.image}" class="prod-img" alt="${p.name}">
      <div class="prod-name">${p.name}</div>
      <div class="prod-desc">${p.description}${p.size?' | Size: '+p.size:''}</div>
      <div class="price">₹ ${p.price}</div>
      <button class="add-btn" onclick="addToCart('${p.id}')">Add to Cart</button>
    `;
    grid.appendChild(card);
  });
}

function populateCategories(){
  const cats = [...new Set(PRODUCTS.map(p=>p.category))];
  cats.forEach(c=>{
    const opt=document.createElement('option');
    opt.value=c; opt.textContent=c;
    filter.appendChild(opt);
  });
}

// Cart
function addToCart(id){ if(!cart[id]) cart[id]=1; else cart[id]++; updateCartCount(); }
function updateCartCount(){ document.getElementById('cartCount').innerText=Object.values(cart).reduce((a,b)=>a+b,0); }

const cartModal = document.getElementById('cartModal');
document.getElementById('viewCartBtn').onclick=()=>{cartModal.style.display='flex'; renderCartItems();}
document.getElementById('closeCartBtn').onclick=()=>{cartModal.style.display='none';}

function renderCartItems(){
  const cartItemsDiv = document.getElementById('cartItems');
  cartItemsDiv.innerHTML='';
  Object.keys(cart).forEach(id=>{
    const p = PRODUCTS.find(x=>x.id===id);
    const qty = cart[id];
    const div=document.createElement('div');
    div.className='cart-item';
    div.innerHTML=`
      <img src="${p.image}" alt="${p.name}">
      <div class="cart-item-info">
        <div class="cart-item-name">${p.name}</div>
        <div class="cart-item-price">₹ ${p.price} x ${qty} = ₹ ${p.price*qty}</div>
      </div>
    `;
    cartItemsDiv.appendChild(div);
  });
}

// WhatsApp + PDF
document.getElementById('generatePDFBtn').onclick=async()=>{
  if(Object.keys(cart).length===0){ alert('Cart empty'); return; }
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();
  let y=10;
  pdf.setFontSize(16); pdf.text('YES FASHION HUB Order',10,y); y+=10;
  let total=0;
  for(const id of Object.keys(cart)){
    const p = PRODUCTS.find(x=>x.id===id);
    const qty = cart[id]; total+=p.price*qty;
    pdf.setFontSize(12); pdf.text(`${p.name} | ₹${p.price} x ${qty} = ₹${p.price*qty}`,10,y); y+=7;
    const imgData = await loadImage(p.image); pdf.addImage(imgData,'JPEG',10,y,40,40); y+=45;
    if(y>250){ pdf.addPage(); y=10; }
  }
  pdf.setFontSize(14); pdf.text(`Total: ₹${total}`,10,y+5);
  const blob = pdf.output('blob');
  const url = URL.createObjectURL(blob);
  
  // WhatsApp message with PDF link
  let msg = `*YES FASHION HUB Order*\nTotal: ₹${total}\nPDF Link: ${url}`;
  const waURL = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`;
  window.open(waURL,'_blank');
};

// Image helper
function loadImage(url){ return new Promise(resolve=>{ const img=new Image(); img.crossOrigin='anonymous'; img.onload=()=>{ const c=document.createElement('canvas'); c.width=img.width; c.height=img.height; c.getContext('2d').drawImage(img,0,0); resolve(c.toDataURL('image/jpeg')); }; img.src=url; }); }

filter.addEventListener('change',renderProducts);
search.addEventListener('input',renderProducts);
loadProducts();
  
</script>
</body>
</html>
